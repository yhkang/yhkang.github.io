<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>初识IPv6 - yhkang&#39;s blog</title><meta name="description" content="偶然发现家里用的宽带已经支持IPv6, 折腾下看看……"><meta property="og:type" content="article"><meta property="og:title" content="初识IPv6"><meta property="og:url" content="https://yhkang.me/2020/01/05/%E5%88%9D%E8%AF%86IPv6/index.html"><meta property="og:site_name" content="yhkang&#39;s blog"><meta property="og:description" content="偶然发现家里用的宽带已经支持IPv6, 折腾下看看……"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://yhkang.me/images/og_image.png"><meta property="article:published_time" content="2020-01-05T13:36:06.000Z"><meta property="article:modified_time" content="2020-05-03T18:50:11.742Z"><meta property="article:author" content="yhkang"><meta property="article:tag" content="网络"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://yhkang.me/images/og_image.png"><link rel="icon" href="/images/favicon-32x32-next.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/github-gist.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><link rel="stylesheet" href="/css/back-to-top.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-162933326-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-162933326-1")</script><link rel="stylesheet" href="/css/progressbar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><link rel="stylesheet" href="/css/style.css"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand is-flex-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/favicon-32x32-next.png" alt="初识IPv6" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a> <a class="navbar-item" href="/archives/">Archives</a> <a class="navbar-item" href="/categories/">Categories</a> <a class="navbar-item" href="/tags/">Tags</a> <a class="navbar-item" href="/about/">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://www.github.com/yhkang"><i class="fab fa-github"></i> </a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i> </a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main"><div class="card"><div class="card-content article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-angle-double-right"></i>初识IPv6</h1><div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto"><div class="level-left"><time class="level-item has-text-grey" datetime="2020-01-05T13:36:06.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2020-01-05</time> <time class="level-item has-text-grey is-hidden-mobile" datetime="2020-05-03T18:50:11.742Z"><i class="far fa-calendar-check">&nbsp;</i>2020-05-04</time> <span class="level-item has-text-grey"><i class="far fa-clock"></i>&nbsp; 10 分钟 读完 (大约 1545 个字) </span><span class="level-item has-text-grey" id="busuanzi_container_page_pv"><i class="far fa-eye"></i> <span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><div class="content"><p>偶然发现家里用的宽带已经支持IPv6, 折腾下看看……</p><a id="more"></a><blockquote><p>这两天偶然发现家里用的浙江联通宽带已经支持IPv6，虽然我的无线路由器还不支持，但是网线直连光猫的电脑已经可以看到分配的IPv6地址。</p></blockquote><h2 id="什么是IPv6"><a href="#什么是IPv6" class="headerlink" title="什么是IPv6"></a>什么是IPv6</h2><p>自己看维基百科 <a href="https://zh.wikipedia.org/wiki/IPv6">https://zh.wikipedia.org/wiki/IPv6</a></p><h2 id="我的IPv6网络信息"><a href="#我的IPv6网络信息" class="headerlink" title="我的IPv6网络信息"></a>我的IPv6网络信息</h2><blockquote><p>出于安全隐私考虑，本文中的IP地址都被“修饰”过</p></blockquote><p>通过<a href="https://test-ipv6.com/这个网站可以查看自己网络对于ipv6的支持情况，下图是我的网络测试情况：">https://test-ipv6.com/这个网站可以查看自己网络对于ipv6的支持情况，下图是我的网络测试情况：</a></p><p><img src="/assets/image-20200105202418639.png" alt="image-20200105202418639"></p><!-- more --><p>再看下以太网适配器的配置信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line">IPv6 地址 . . . . . . . . . . . . : 2408:8360:729:a000:b512:46b1:420c:9da8</span><br><span class="line">临时 IPv6  地址. . . . . . . . . . : 2408:8360:729:a000:c027:5ee8:d275:c280</span><br><span class="line">本地链接 IPv6 地址. . . . . . . . : fe80::b512:46b1:420c:9da8%6</span><br><span class="line">IPv4 地址 . . . . . . . . . . . . : 192.168.1.3</span><br></pre></td></tr></table></figure><p>值得注意的是，这台设备被分配了2个全球单播地址（<strong>IPv6地址</strong>和<strong>临时IPv6地址</strong>）和1个链路本地地址，并有如下特征：</p><ul><li>IPv6地址和临时IPv6地址的前缀是一样的<code>2408:8360:729:a000</code></li><li>本地链接 IPv6前缀为<code>fe80::</code>，后缀和IPv6地址是一样的<code>b512:46b1:420c:9da</code></li><li>在test-ipv6网站中显示的地址是临时IPv6地址</li></ul><p>再来看下光猫里的配置信息：</p><p><img src="/assets/image-20200105195403021.png" alt="image-20200105195403021"></p><p>注意这里面的获取前缀<code>2408:8360:729:a000::/60</code>，表明着运营商分配的前缀长度是60位，剩余的68位地址就是我们的子网容量，这也就意味着在这个光猫下可以容纳2的68次方个地址！给家里每一粒灰层分配一个估计都用不完。</p><h2 id="深入理解IPv6"><a href="#深入理解IPv6" class="headerlink" title="深入理解IPv6"></a>深入理解IPv6</h2><p>现在我们对IPv6有了直观的认识，接下来看看这128位地址究竟是如何生成的，以及三个不同的IPv6地址分别有什么作用。</p><h3 id="IPv6地址格式"><a href="#IPv6地址格式" class="headerlink" title="IPv6地址格式"></a>IPv6地址格式</h3><p>IPv6二进位制下为128位长度，以16位为一组，每组以冒号“:”隔开，可以分为8组，每组以4位十六进制方式表示。例如：<code>2001:0db8:86a3:08d3:1319:8a2e:0370:7344</code> 是一个合法的IPv6地址。</p><h3 id="IPv6地址生成方法"><a href="#IPv6地址生成方法" class="headerlink" title="IPv6地址生成方法"></a>IPv6地址生成方法</h3><p>IPv6支持无状态配置（SLAAC），网络接口接上后能自动生成若干个地址，地址一般分为网络段和主机段，各占64位。IPv6地址分配机制只管高64位的分配，低64位的标识符（主机段）则由主机自己来保证唯一性。</p><p>标识符的生成算法包括但不限于：</p><ul><li>EUI-64规则根据MAC地址生成，用于一般局域网或者物联网（Windows XP, Windows Server 2003及大多数Linux发行版都采用这种方式生成）</li><li>低碰撞的随机数算法随机生成，用于生成临时地址实现隐私扩展（出于安全考虑，Windows Vista及之后的Windows系统都默认采用随机算法）</li><li>人工配置保证唯一，用于配置一个服务器集群</li><li>anycast地址，全0，本来就可以多路访问</li></ul><h3 id="IPv6隐私扩展"><a href="#IPv6隐私扩展" class="headerlink" title="IPv6隐私扩展"></a>IPv6隐私扩展</h3><p>当一个客户端使用SLAAC配置其IPv6时，它会使用网络前缀和网卡的MAC地址构造地址。这会引起安全问题：计算机的MAC地址可以轻松通过其IPv6地址推算出，即使漫游到其他物理位置，由于MAC地址的全球唯一性，依然可以定位到客户端的设备。</p><p>IPv6实现了一种使用临时地址访问服务器的方式：在连接远程服务器时，内核会从原本的IPv6地址计算生成一个“临时地址”，系统会优先选择这个地址以隐藏原来的地址。每一个时刻只有一个临时地址是有效的，在一个地址过期时会立刻生成一个新的地址作为新的临时地址。</p><h3 id="三个地址的作用"><a href="#三个地址的作用" class="headerlink" title="三个地址的作用"></a>三个地址的作用</h3><ul><li>本地链路地址：用于本地网络通信和网络配置</li><li>临时全球地址：用于对外访问</li><li>固定全球地址：可用于固定监听外部对你的访问</li></ul><h2 id="有什么用呢"><a href="#有什么用呢" class="headerlink" title="有什么用呢"></a>有什么用呢</h2><p>有了IPv6地址，意味着联网的设备不再是隐藏在NAT后面，而是全都具有公网IP。有了公网IP，那是不是可以直接在电脑上搭建提供Web服务呢？</p><p>启动个简单的web服务来试一下</p><p><img src="/assets/image-20200105204502736.png" alt="image-20200105204502736"></p><p>看到这个打印信息就觉得不太行，似乎只支持IPv4，通过浏览器分别访问下IPv6地址果然不行</p><p><img src="/assets/image-20200105205322509.png" alt="image-20200105205322509"></p><p>换成Caddy试试</p><p><img src="/assets/image-20200105210305005.png" alt="image-20200105210305005"></p><p>服务启动好了，浏览器里访问试一下，可以了</p><p><img src="/assets/image-20200105211123978.png" alt="image-20200105211123978"></p><p>在本机上三种IPv6地址都能访问，通过手机4G测试在外网<strong>IPv6地址</strong>和<strong>临时IPv6地址</strong>均能访问成功。</p><p>看起来ISP还没有针对80端口进行封禁，不过经过这两天观察，光猫上分配的前缀是会变化的，如果想搭建网站或者服务需要采用DDNS等手段，有空了再试。</p><h2 id="安全性问题"><a href="#安全性问题" class="headerlink" title="安全性问题"></a>安全性问题</h2><p>通过上面的测试我意识到一个问题，那就是我的设备端口现在等于直接暴露在公网环境中，我随便起了个Web服务就能在公网中访问到，如果有什么漏洞真是不堪设想。那是不是以后开发本地启动项目暴露的端口，也直接在公网上可以访问，不过现在Win10默认自带防火墙，开启如下设置即可。</p><p><img src="/assets/image-20200105212403400.png" alt="image-20200105212403400"></p><p>按理说阻止入站连接应该是路由器的默认防火墙安全级别，很遗憾联通的这个光猫似乎并没有防火墙。</p></div><ul class="post-copyright"><li><strong>本文标题：</strong><a href="https://yhkang.me/2020/01/05/%E5%88%9D%E8%AF%86IPv6/">初识IPv6</a></li><li><strong>本文作者：</strong><a href="https://yhkang.me">yhkang</a></li><li><strong>本文链接：</strong><a href="https://yhkang.me/2020/01/05/%E5%88%9D%E8%AF%86IPv6/">https://yhkang.me/2020/01/05/%E5%88%9D%E8%AF%86IPv6/</a></li><li><strong>发布时间：</strong>2020-01-05</li><li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li></ul><hr style="height:1px;margin:1rem 0"><div class="level is-size-7 is-uppercase"><div class="level-start"><div class="level-item"><i class="fas fa-tags has-text-grey"></i>&nbsp; <a class="has-link-grey -link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></div></div></div></div></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i> </span><span>微信</span><div class="qrcode"><img src="/images/wechat.jpg" alt="微信"></div></a></div></div></div><div class="card card-transparent"><div class="level post-navigation is-flex-wrap is-mobile"><div class="level-start"><a class="level level-item has-link-grey article-nav-prev" href="/2020/04/05/%E5%A5%97%E6%8E%A5%E5%AD%97%E6%8E%A5%E5%8F%A3/"><i class="level-item fas fa-chevron-left"></i> <span class="level-item">套接字接口</span></a></div><div class="level-end"><a class="level level-item has-link-grey article-nav-next" href="/2019/12/28/JVM%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"><span class="level-item">JVM和垃圾回收</span> <i class="level-item fas fa-chevron-right"></i></a></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5 has-text-weight-normal">评论</h3><script>var disqus_config=function(){this.page.url="https://yhkang.me/2020/01/05/%E5%88%9D%E8%AF%86IPv6/",this.page.identifier="2020/01/05/初识IPv6/"};!function(){var e=document,t=e.createElement("script");t.src="//yhkangme.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><div class="column is-4-tablet is-4-desktop is-3-widescreen has-order-1 column-left"><div class="card widget"><div class="card-content"><nav class="level" style="margin-bottom:1rem"><div class="level-item has-text-centered" style="flex-shrink:1"><div><figure class="image is-96x96 has-mb-6"><img src="https://www.gravatar.com/avatar/8f5167701c03795f7d5f1c1583e7f7b1?s=96" alt="yhkang"></figure><p class="is-size-4 is-block">yhkang</p><p class="is-size-6 is-block">Life, the universe, and everything</p><p class="is-size-6 is-flex is-flex-center has-text-grey"><i class="fas fa-map-marker-alt has-mr-7"></i> <span>Hangzhou, China</span></p></div></div></nav><nav class="level menu-list is-mobile" style="margin-bottom:1rem"><div class="level-item has-text-centered is-marginless"><a href="/archives/"><p class="heading">文章</p><p class="title has-text-weight-normal">8</p></a></div><div class="level-item has-text-centered is-marginless"><a href="/categories/"><p class="heading">分类</p><p class="title has-text-weight-normal">0</p></a></div><div class="level-item has-text-centered is-marginless"><a href="/tags/"><p class="heading">标签</p><p class="title has-text-weight-normal">8</p></a></div></nav><div class="level"><a class="level-item button is-link is-rounded" href="https://www.github.com/yhkang" target="_blank" rel="noopener"><i class="fab fa-github"></i>&nbsp;&nbsp;关注我</a></div><div class="level is-mobile"><a class="level-item button is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/yhkang"><i class="fab fa-github"></i> </a><a class="level-item button is-white is-marginless" target="_blank" rel="noopener" title="Telegram" href="https://t.me/yhkang"><i class="fab fa-telegram"></i> </a><a class="level-item button is-white is-marginless" target="_blank" rel="noopener" title="E-Mail" href="mailto:yahuakang@gmail.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget column-left is-sticky" id="toc"><div class="card-content" style="max-height:calc(100vh - 22px);overflow:scroll"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex" href="#什么是IPv6"><span class="has-mr-6">1</span> <span>什么是IPv6</span></a></li><li><a class="is-flex" href="#我的IPv6网络信息"><span class="has-mr-6">2</span> <span>我的IPv6网络信息</span></a></li><li><a class="is-flex" href="#深入理解IPv6"><span class="has-mr-6">3</span> <span>深入理解IPv6</span></a><ul class="menu-list"><li><a class="is-flex" href="#IPv6地址格式"><span class="has-mr-6">3.1</span> <span>IPv6地址格式</span></a></li><li><a class="is-flex" href="#IPv6地址生成方法"><span class="has-mr-6">3.2</span> <span>IPv6地址生成方法</span></a></li><li><a class="is-flex" href="#IPv6隐私扩展"><span class="has-mr-6">3.3</span> <span>IPv6隐私扩展</span></a></li><li><a class="is-flex" href="#三个地址的作用"><span class="has-mr-6">3.4</span> <span>三个地址的作用</span></a></li></ul></li><li><a class="is-flex" href="#有什么用呢"><span class="has-mr-6">4</span> <span>有什么用呢</span></a></li><li><a class="is-flex" href="#安全性问题"><span class="has-mr-6">5</span> <span>安全性问题</span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start has-text-centered-mobile"><a class="footer-logo is-block has-mb-6" href="/"><img src="/images/favicon-32x32-next.png" alt="初识IPv6" height="28"></a><p class="is-size-7">&copy; 2020 yhkang&nbsp; Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle"><p class="control"><a class="button is-white is-large" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i>&nbsp;</a></p><p class="control"><a class="button is-white is-large" target="_blank" rel="noopener" title="GitHub" href="https://www.github.com/yhkang"><i class="fab fa-github"></i>&nbsp;</a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={site:{url:"https://yhkang.me",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script src="/js/gallery.js" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"flex"})})</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script>document.addEventListener("DOMContentLoaded",function(){MathJax.Hub.Config({"HTML-CSS":{matchFontHeight:!1},SVG:{matchFontHeight:!1},CommonHTML:{matchFontHeight:!1},tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}})})</script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..."> <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(无标题)"},CONTENT_URL:"/content.json"}</script><script src="/js/insight.js" defer></script><link rel="stylesheet" href="/css/search.css"><link rel="stylesheet" href="/css/insight.css"></body></html>